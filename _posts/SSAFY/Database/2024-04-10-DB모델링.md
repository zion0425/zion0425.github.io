---
title: DB 모델링
date: 2024-04-10
categories: [MySQL]
tags: [Modeling]
published: false
---

## 목차

- <a href ="#1" >DB 모델링</a>

# <font id = "1">DB모델링</font>

요구사항을 분석하여 개념적 모델링

## 개념적 모델링

요구사항 분석을 토대로 필요한 데이터를 Entity로 추출하고 속성을 구성하며 ER-Diagrame으로 정의하는 단계

> ERDiagram<br/>[https://behappyaftercoding.tistory.com/30]()

1. 개체(Entity)

데이터로 관리되야 하는 주요 객체(사람, 사물, 장소, 사건 등)

- 영속적이며 속성을 가진 명사

2. 속성 (Attribute)

개체의 세부사항 (성질, 분류, 수량 등)

- 기초 속성

- 추출 속성<br/>
  기초 속성으로부터 계산(가공)한 속성

- 설계 속성<br/>
  시스템 효율성을 위해 설계자가 임의로 부여하는 속성

### 식별자

- **기본키 (Primary Key)**<br/>
  개체를 식별할 수 있는 유일키

- 후보키<br/>
  개체 내에서 각각의 인스턴스를 구분할 수 있는 속성으로 기본키가 될 수 있는 키

- 대체키

- 복합키

- 대리키

3. 관계

Entity간의 관계를 표현

- 관계 차수

  **차수성 (cardinality)**

  하나의 인스턴스가 다른 인스턴스에 연결 가능한 개수,

  개체간의 관계를 1:1, 1:n, n:n 으로 표현

- 선택성

  개체간의 관계를 표현할 때, 객체가 반드시 필요한지 표현

## 논리적 모델링

ERD를 Mapping Rule을 적용하여 스키마를 설계하고 필요시 정규화하는 과정

기본키는 Not Null, Unique

참조키는 일반적으로 부모 테이블의 PK로 지정한다. Null 가능.

**Mapping Rule**

Entity -> Table
Attribute -> Column
Identifier -> PK
Relation -> FK, Table

M:N 관계는 PK 제약 조건에 위배된다.

이를 해소하기 위해 정규화한다.

## 정규화

1. 제 1 정규화

반복되는 속성을 제거하여 기본 테이블의 기본키를 추가해 새로운 테이블을 생성하고 기존 테이블과 1:N 관계 형성

정규화를 진행하지 않으면, 부수적인 데이터를 저장하기 위해 기본 데이터가 중복된다는 문제점이 발생한다.

제 1 정규화는 **반복 그룹이 존재하면 안 되고**, **모든 행은 식별자로 완전하게 구분**되어야 한다는 원칙에 의거하여 진행한다.

| Student | student_id | name | subject_name |
| ------- | ---------- | ---- | ------------ |
|         | 1          | na1  | sub1         |
|         | 1          | na1  | sub2         |
|         | 2          | na2  | sub2         |

subject_name에 varchar 타입으로 직접 subject_name을 넣을 경우, subject_name이 변경되면 일일히 값을 변경해야 되는 상황이 발생한다.

이를 해소하기 위해 subject 테이블을 분리하여 따로 관리한다.

| Student | student_id(PK) | name |
| ------- | -------------- | ---- |
|         | 1              | na1  |
|         | 2              | na1  |

| Student_Subject_List | student_id(PK) | subject_id(PK) | name |
| -------------------- | -------------- | -------------- | ---- |
|                      | 1              | 101            | sub1 |
|                      | 1              | 102            | sub2 |
|                      | 2              | 102            | sub2 |

이렇게 될 경우 Student 테이블의 경우 반복그룹이 존재하지 않고, 모든 행이 식별자로 구분된다.

Subject 테이블은 모든 행이 식별자로 구분되지 않으므로, stduent_id 와 subject_id를 복합키로 사용한다.

2. 제 2 정규화

제 1 정규화를 진행해도, 복합키로 인해 부분적으로 종속되는 함수 중복관계가 존재한다.

이를 제거하기 위해 복합키를 분리히여 두 개의 테이블로 나눈다.

| Student | student_id(PK) | name |
| ------- | -------------- | ---- |
|         | 1              | na1  |
|         | 2              | na2  |

| Student_Subject_List | student_id(PK) | subject_id(PK) | name |
| -------------------- | -------------- | -------------- | ---- |
|                      | 1              | 101            | sub1 |
|                      | 1              | 102            | sub2 |
|                      | 2              | 102            | sub2 |

이 중, Student Subject List 테이블을 Subject 테이블로 나눈다.

여기서 subject의 name 컬럼은 subject_id에 종속되지만, stduent id에는 종속되지 않는다는 것을 알 수 있다.

이를 해소하기 위해, 제 2 정규화를 통해 테이블을 분리한다.

| Student_Subject_List | student_id(PK) | subject_id(PK, FK) |
| -------------------- | -------------- | ------------------ |
|                      | 1              | 101                |
|                      | 1              | 102                |
|                      | 2              | 102                |

| Subject | subject_id(PK) | name |
| ------- | -------------- | ---- |
|         | 101            | sub1 |
|         | 102            | sub2 |

3. 제 3 정규화

기본키에 의존하지 않고 일반 컬럼에 의존되는 컬럼을 분리한다.

| Student | student_id(PK) | Univercity  | majer        |
| ------- | -------------- | ----------- | ------------ |
|         | 1              | 예체능 대학 | 뮤지컬학과   |
|         | 2              | 공과 대학   | 컴퓨터공학과 |

위의 테이블의 전공은 일반 컬럼인 대학에 종속된다는 것을 확인할 수 있다.

이를 분리하는 것이 제 3 정규화 이다.

| student_id(PK) | majer        |
| -------------- | ------------ |
| 1              | 뮤지컬학과   |
| 2              | 컴퓨터공학과 |

| majer(PK)    | Univercity  |
| ------------ | ----------- |
| 뮤지컬학과   | 예체능 대학 |
| 컴퓨터공학과 | 공과 대학   |

## 물리적 모델링

논리적으로 구석된 스키마를 실제 DB로 구현하는 과정이다.

구체적으로 컬럼의 도메인 (INT, VARCHAR ...)을 정의하고, 상황에 따라 반정규화를 실행하는 과정이다.

반정규화는 정규화에 위배되거나 Transaction을 고려하여 테이블을 재구성 하는 과정을 의미한다.

## Blob vs Binary

일반 Binary Type은 이미지를 단순하게 Binary로 변환하여 저장한 형식이다.

Blob(Binary large object)은 Binary 형식의 데이터를 DB내부에서 이미지로 처리하기 쉽게 구현된 타입이다.

Base64는 바이너리 데이터를 다루기 위해 텍스트 형태로 저장한 포멧

## Table PK : Id (Auto Increment)

Table의 PK를 지정하는 관습으로 Table Name + ID 로 AI로 지정한 방식이 존재한다.

PK를 AI로 Index로 지정하면 강제적으로 데이터 무결성을 보장할 수 있다.
